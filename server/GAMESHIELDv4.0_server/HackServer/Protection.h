#pragma once

#pragma comment(lib, "iphlpapi.lib")
#pragma comment(lib, "Wininet")

#define PROTECT_START _asm _emit 0xEB _asm _emit 0x0E _asm _emit 0x14 _asm _emit 0x28 _asm _emit 0xCD _asm _emit 0xDB _asm _emit 0x50 _asm _emit 0x63 _asm _emit 0xAF _asm _emit 0x22 _asm _emit 0x75 _asm _emit 0xEE _asm _emit 0xB5 _asm _emit 0xD8 _asm _emit 0x43 _asm _emit 0x72
#define PROTECT_FINAL _asm _emit 0xEB _asm _emit 0x0E _asm _emit 0x37 _asm _emit 0xF2 _asm _emit 0xCD _asm _emit 0xDB _asm _emit 0x50 _asm _emit 0x63 _asm _emit 0xAF _asm _emit 0x22 _asm _emit 0x75 _asm _emit 0xEE _asm _emit 0xB5 _asm _emit 0xD8 _asm _emit 0x85 _asm _emit 0x61
#define CRASH_APPLICATION_MACRO _asm _emit 0xFF _asm _emit 0x25 _asm _emit 0x00 _asm _emit 0x00 _asm _emit 0x00 _asm _emit 0x00

enum eCustomers
{
	LTPTeam = 18,
	CrystalMu = 24,
	FromName = 25,
	MuEscape = 30,
	h3yShOk = 32,
	Freemod2 = 43,
	Na1koN = 44,
	WorkPC = 45,
	Kronos = 47,
	MuFighters = 51,
	AndreiMedoni = 55,
	LetsplayMu = 59,
	Dionis = 61,
	KEIZ = 62,
	MuEver = 68,
	freemu = 70,
	Genesis = 71,
	MuVavilon = 73,
	Resistant = 75,
	RemalResul = 76,
	House = 77,
	SkyDayMu = 78,
	VitalyaKrim = 79,
	WorkNotebook = 80,
	XMIRA = 82,
	EveRMu = 83,
	Rasim = 89,
	VitalyStemirov = 91,
	Nlcos = 95,
	Game4Az = 96,
	ServerPC = 97,
	Mephis = 99,
	MarkIvanov = 100,
	KillMeRu = 101,
	MuLambda = 103,
	wo7as = 104,
	UnSleep = 105,
	MuRampageSaneok = 106,
	williams = 107,
	PavelBruyako = 108,
	fairyMu = 110,
	MuGoblet = 111,
	OLEG = 113,
	Anatolii = 114,
	medvedb = 116,
	NationMu = 117,
};

class CProtection
{
public:
	CProtection();
	virtual ~CProtection();
	void CheckHosts(char* File);
	void GetComputerHardwareId();
	static size_t WriteCallback(void *contents, size_t size, size_t nmemb, void *userp);
	void Auth(HINSTANCE hIns, HWND hWnd);
	bool Auth(HINSTANCE hIns, HWND hWnd, int type);
	inline void ErrorMessageBox1();
	void InfoBox(char* message,...);
	void ConnectionErrorBox();
	inline void SafeExitProcess();
	char* GetEncryptedString(BYTE* string,int size);
public:
	char m_ComputerHardwareId[36];
	BYTE m_EncKey;
	HINSTANCE hInst;
	HWND ghWnd;
	char CustomerName[100];
	int m_LicenseActive;
	int m_Debt;
	int m_Index;

	HWND			Unk297;
	// ------
	int				Unk349;
	int				qy;
	int				qx;
	char			txt[128];
	char			t[255];
}; extern CProtection gProtection;

static BYTE gProtectString1[04] = {0xF3,0x8A,0xEC,0xB0}; //"C:\\"
static BYTE gProtectString2[20] = {0x95,0x80,0x88,0xE8,0x9D,0x95,0x80,0x88,0xE8,0x9D,0x95,0x80,0x88,0xE8,0x9D,0x95,0x80,0x88,0xE8,0xB0}; //"%08X-%08X-%08X-%08X"
static BYTE gProtectString3[50] = {0xD8,0xC4,0xC4,0xC0,0x8A,0x9F,0x9F,0xD7,0xC5,0xD9,0xD4,0xD5,0x9E,0xDC,0xC4,0xC0,0x9D,0xC4,0xD5,0xD1,0xDD,0x9E,0xC2,0xC5,0x9F,0xDC,0xD9,0xD3,0xD5,0xDE,0xC3,0xD5,0x9F,0xD7,0xD5,0xC4,0xD9,0xDE,0xD6,0xDF,0x9E,0xC0,0xD8,0xC0,0x8F,0xD3,0xDF,0xD4,0xD5,0x8D}; // http://guide.ltp-team.ru//license//getinfo.php?code=
static BYTE gProtectString4[35] = {0xF3,0xDF,0xC5,0xDC,0xD4,0x90,0xDE,0xDF,0xC4,0x90,0xD1,0xC5,0xC4,0xD8,0xD5,0xDE,0xC4,0xD9,0xD3,0xD1,0xC4,0xD5,0x90,0xC4,0xD8,0xD5,0x90,0xDD,0xD1,0xD3,0xD8,0xD9,0xDE,0xD5,0xB0}; // "Could not authenticate the machine"
static BYTE gProtectString5[60] = {0xE9,0xDF,0xC5,0xC2,0x90,0xDC,0xD9,0xD3,0xD5,0xDE,0xC3,0xD5,0x90,0xC4,0xD5,0xDD,0xC0,0xDF,0xC2,0xD1,0xC2,0xD9,0xDC,0xC9,0x90,0xD4,0xD9,0xC3,0xD1,0xD2,0xDC,0xD5,0xD4,0x91,0xBA,0xE0,0xDC,0xD5,0xD1,0xC3,0xD5,0x9C,0x90,0xD3,0xDF,0xDE,0xC4,0xD1,0xD3,0xC4,0x90,0xC3,0xC5,0xC0,0xC0,0xDF,0xC2,0xC4,0x91,0xB0}; // "Your license temporarily disabled!\nPlease, contact support!"
static BYTE gProtectString6[37] = {0xE9,0xDF,0xC5,0x90,0xDF,0xC7,0xD5,0x90,0x95,0xD4,0x94,0x91,0xBA,0xE0,0xDC,0xD5,0xD1,0xC3,0xD5,0x90,0xC2,0xD5,0xC4,0xC5,0xC2,0xDE,0x90,0xC4,0xD8,0xD5,0x90,0xD4,0xD5,0xD2,0xC4,0x91,0xB0}; // "You owe %d$!\nPlease return the debt!"
static BYTE gProtectString7[60] = {0xD8,0xC4,0xC4,0xC0,0x8A,0x9F,0x9F,0xD7,0xC5,0xD9,0xD4,0xD5,0x9E,0xDC,0xC4,0xC0,0x9D,0xC4,0xD5,0xD1,0xDD,0x9E,0xC2,0xC5,0x9F,0x9F,0xDC,0xD9,0xD3,0xD5,0xDE,0xC3,0xD5,0x9F,0x9F,0xD7,0xD5,0xC4,0xD9,0xDE,0xD6,0xDF,0x9E,0xC0,0xD8,0xC0,0x8F,0xC4,0xC9,0xC0,0xD5,0x8D,0x81,0x8F,0xD3,0xDF,0xD4,0xD5,0x8D,0xB0}; // "http://guide.ltp-team.ru//license//getinfo.php?type=1?code="
static BYTE gProtectString8[30] = {0xF3,0xD1,0xDE,0x97,0xC4,0x90,0xD3,0xDF,0xDE,0xDE,0xD5,0xD3,0xC4,0x90,0xC4,0xDF,0x90,0xD1,0xC5,0xC4,0xD8,0x90,0xC3,0xD5,0xC2,0xC6,0xD5,0xC2,0x91,0xB0}; // Can't connect to auth server!
static BYTE gProtectString9[53] = {0xD8,0xC4,0xC4,0xC0,0x8A,0x9F,0x9F,0xDC,0xD9,0xD3,0xD5,0xDE,0xC3,0xD5,0x9E,0xDC,0xC4,0xC0,0x9D,0xC4,0xD5,0xD1,0xDD,0x9E,0xD3,0xDF,0xDD,0x9F,0xDC,0xD9,0xD3,0xD5,0xDE,0xC3,0xD5,0x9F,0xD7,0xD5,0xC4,0xD9,0xDE,0xD6,0xDF,0x9E,0xC0,0xD8,0xC0,0x8F,0xD3,0xDF,0xD4,0xD5,0x8D}; // http://license.ltp-team.com/license/getinfo.php?code=
static BYTE gProtectString10[54] = {0xD8,0xC4,0xC4,0xC0,0x8A,0x9F,0x9F,0xDC,0xD9,0xD3,0xD5,0xDE,0xC3,0xD5,0x9E,0xD6,0xD1,0xD9,0xC2,0xC9,0x9D,0xDD,0xC5,0x9E,0xC2,0xC5,0x9F,0x9F,0xDC,0xD9,0xD3,0xD5,0xDE,0xC3,0xD5,0x9F,0x9F,0xD7,0xD5,0xC4,0xD9,0xDE,0xD6,0xDF,0x9E,0xC0,0xD8,0xC0,0x8F,0xD3,0xDF,0xD4,0xD5,0x8D}; // http://license.fairy-mu.ru//license//getinfo.php?code=

static BYTE gHostsString1[11] = {0xDC,0xC4,0xC0,0x9D,0xC4,0xD5,0xD1,0xDD,0x9E,0xC2,0xC5}; //ltp-team.ru
static BYTE gHostsString2[12] = {0xDC,0xC4,0xC0,0x9D,0xC4,0xD5,0xD1,0xDD,0x9E,0xD3,0xDF,0xDD}; //ltp-team.com
static BYTE gHostsString3[11] = {0xD6,0xD1,0xD9,0xC2,0xC9,0x9D,0xDD,0xC5,0x9E,0xC2,0xC5}; //fairy-mu.ru

static BYTE gHostsFile1[27] = {0xEC,0xE3,0xC9,0xC3,0xC4,0xD5,0xDD,0x83,0x82,0xEC,0xD4,0xC2,0xD9,0xC6,0xD5,0xC2,0xC3,0xEC,0xD5,0xC4,0xD3,0xEC,0xD8,0xDF,0xC3,0xC4,0xC3};
static BYTE gHostsFile2[31] = {0xEC,0xE3,0xC9,0xC3,0xC4,0xD5,0xDD,0x83,0x82,0xEC,0xD4,0xC2,0xD9,0xC6,0xD5,0xC2,0xC3,0xEC,0xD5,0xC4,0xD3,0xEC,0xD8,0xDF,0xC3,0xC4,0xC3,0x9E,0xD9,0xD3,0xC3};


static BYTE gProtectAttr1[12] = {0xFC,0xD9,0xD3,0xD5,0xDE,0xC3,0xD5,0xF9,0xDE,0xD6,0xDF,0xB0}; //"LicenseInfo"
static BYTE gProtectAttr2[8] = {0xFC,0xD9,0xD3,0xD5,0xDE,0xC3,0xD5,0xB0}; //"License";
static BYTE gProtectAttr3[9] = {0xFE,0xDF,0xC4,0xF6,0xDF,0xC5,0xDE,0xD4,0xB0}; //"NotFound"
static BYTE gProtectAttr4[5] = {0xFE,0xD1,0xDD,0xD5,0xB0}; //"Name"
static BYTE gProtectAttr5[9] = {0xF9,0xC3,0xF1,0xD3,0xC4,0xD9,0xC6,0xD5,0xB0}; //"IsActive"
static BYTE gProtectAttr6[5] = {0xF3,0xDF,0xD4,0xD5,0xB0}; //"Code"
static BYTE gProtectAttr7[5] = {0xF4,0xD5,0xD2,0xC4,0xB0}; //"Debt"
static BYTE gProtectAttr8[8] = {0xF3,0xC5,0xC3,0xC4,0xDF,0xDD,0xC3,0xB0}; //"Customs"
static BYTE gProtectAttr9[7] = {0xF3,0xC5,0xC3,0xC4,0xDF,0xDD,0xB0}; //"Custom"
static BYTE gProtectAttr10[6] = {0xF9,0xDE,0xD4,0xD5,0xC8,0xB0}; //"Index"
static BYTE gProtectAttr11[8] = {0xE6,0xD5,0xC2,0xC3,0xD9,0xDF,0xDE,0xB0}; //"Version"
static BYTE gProtectAttr12[15] = {0xF3,0xC5,0xC2,0xC2,0xD5,0xDE,0xC4,0xE6,0xD5,0xC2,0xC3,0xD9,0xDF,0xDE,0xB0}; //"CurrentVersion"

static BYTE gRootHWID[36] = {0x86,0xF5,0x89,0xF2,0xF5,0x89,0x84,0xF2,0x9D,0xF2,0x85,0xF3,0x88,0x89,0x80,0xF2,0xF5,0x9D,0x86,0xF4,0x81,0x89,0xF2,0xF1,0xF5,0xF1,0x9D,0xF1,0xF2,0x82,0x81,0xF5,0x81,0x80,0x88,0xB0}; // ROOT HWID